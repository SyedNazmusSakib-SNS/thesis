<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thesis Presentation Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .slide-item.active {
            background-color: #0f766e; /* teal-700 */
            color: white;
            border-left: 4px solid #ccfbf1; /* teal-100 */
        }
        .slide-item:hover:not(.active) {
            background-color: #1e293b; /* slate-800 */
        }
        /* Custom Scrollbar for Sidebar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        ::-webkit-scrollbar-thumb {
            background: #334155; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #475569; 
        }

        /* Fullscreen Presentation Mode */
        body.presentation-mode {
            overflow: hidden !important;
            background: #0f0f1a !important;
        }
        body.presentation-mode .sidebar {
            display: none !important;
        }
        body.presentation-mode .toolbar {
            display: none !important;
        }
        body.presentation-mode .main-content {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            padding: 0 !important;
            margin: 0 !important;
            z-index: 9999 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            background: #0f0f1a !important;
        }
        body.presentation-mode .iframe-wrapper {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            padding: 0 !important;
            margin: 0 !important;
            background: #0f0f1a !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            overflow: hidden !important;
        }
        body.presentation-mode .slide-container {
            /* Keep original slide dimensions */
            width: 1280px !important;
            height: 720px !important;
            max-width: none !important;
            max-height: none !important;
            border-radius: 0 !important;
            box-shadow: 0 0 60px rgba(0,0,0,0.5) !important;
            /* Scale will be applied via JavaScript */
            transform-origin: center center !important;
        }
        body.presentation-mode .slide-container iframe {
            width: 1280px !important;
            height: 720px !important;
        }

        /* Floating Controls in Presentation Mode */
        .presentation-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.85), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            padding-bottom: 12px;
            z-index: 1000;
        }
        body.presentation-mode .presentation-controls {
            display: flex;
        }
        .presentation-controls:hover,
        body.presentation-mode:hover .presentation-controls {
            opacity: 1;
        }
        .pres-btn {
            padding: 10px 16px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        .pres-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }
        .pres-btn i {
            margin-right: 6px;
        }
        .slide-indicator {
            color: white;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
        }

        /* Present Button in Toolbar */
        .present-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #0f766e, #14b8a6);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .present-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4);
        }
    </style>
</head>
<body class="bg-gray-100 h-screen flex overflow-hidden">

    <!-- Sidebar -->
    <aside class="sidebar w-64 bg-slate-900 text-slate-300 flex flex-col shadow-2xl z-10">
        <!-- Sidebar Header -->
        <div class="h-16 flex items-center px-6 bg-slate-950 shadow-md">
            <h1 class="text-lg font-bold text-teal-400 tracking-wide">
                <i class="fas fa-layer-group mr-2"></i>Thesis Slides
            </h1>
        </div>

        <!-- Slide List -->
        <div id="slideList" class="flex-1 overflow-y-auto py-2">
            <!-- Items injected by JS -->
        </div>

        <!-- Sidebar Footer -->
        <div class="p-4 bg-slate-950 text-xs text-center text-slate-500 border-t border-slate-800">
            <div class="mb-1"></div>Use <span class="px-1 py-0.5 bg-slate-800 rounded text-slate-300">←</span> <span class="px-1 py-0.5 bg-slate-800 rounded text-slate-300">→</span> to navigate</div>
            <div>Press <span class="px-1 py-0.5 bg-slate-800 rounded text-slate-300">F5</span> for fullscreen</div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content flex-1 flex flex-col relative">
        
        <!-- Toolbar -->
        <div class="toolbar h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6 shadow-sm z-10">
            <div class="font-medium text-gray-700" id="currentInfo">
                Loading...
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <button onclick="prevSlide()" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 transition-colors" title="Previous (Left Arrow)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="text-sm font-mono text-gray-500 w-16 text-center" id="counter">
                        -- / --
                    </div>
                    <button onclick="nextSlide()" class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 transition-colors" title="Next (Right Arrow)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <button onclick="enterPresentationMode()" class="present-btn" title="Enter Presentation Mode (F5)">
                    <i class="fas fa-play"></i> Present
                </button>
            </div>
        </div>

        <!-- Iframe Container -->
        <div class="iframe-wrapper flex-1 bg-gray-200 p-8 flex items-center justify-center overflow-hidden">
            <div class="slide-container bg-white shadow-2xl rounded-lg overflow-hidden" style="width: 1280px; height: 720px; aspect-ratio: 16/9;">
                <iframe id="slideFrame" src="" class="w-full h-full border-0"></iframe>
            </div>
        </div>

    </main>

    <!-- Floating Presentation Controls (visible only in presentation mode) -->
    <div class="presentation-controls" id="presControls">
        <button class="pres-btn" onclick="prevSlide()" title="Previous Slide">
            <i class="fas fa-chevron-left"></i> Previous
        </button>
        <div class="slide-indicator" id="presCounter">1 / 24</div>
        <button class="pres-btn" onclick="nextSlide()" title="Next Slide">
            Next <i class="fas fa-chevron-right" style="margin-left: 6px; margin-right: 0;"></i>
        </button>
        <button class="pres-btn" onclick="exitPresentationMode()" title="Exit (Escape)">
            <i class="fas fa-times"></i> Exit
        </button>
    </div>

<script>
    const slideFiles = [1, 2, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 27, 20, 22, 24, 28, 31, 32, 33, 34];
    const totalSlides = slideFiles.length; // Should be 24
    let currentSlide = 1;

    // Slide Titles Mapped to Logical Index
    const titles = {
        1: "Title Slide", 
        2: "Background: Evolution to Generalist AI",
        3: "Need for Automated RRG",
        4: "Current Limitations",
        5: "Research Objectives",
        6: "Research Questions",
        7: "Literature Review: Evolution of VLMs",
        8: "Literature Review: SOTA Models and their Limitations",
        9: "Literature Review: Longitudinal Reasoning",
        10: "Literature Review: Structured Representations",
        11: "Literature Review: Hallucination Depth",
        12: "Literature Review: Verification Mechanisms",
        13: "Literature Review: Critical Analysis",
        14: "Methodology: Framework Overview",
        15: "Results: Dataset Composition", 
        16: "Method: Structured Graph",
        17: "Method: Multimodal Fusion",
        18: "Method: Hallucination Mitigation",
        19: "Results: Cohort Characteristics",
        20: "Results: Supervision Coverage",
        21: "Results: Differential Reasoning",
        22: "Results: Error Analysis",
        23: "Conclusion",
        24: "References"
    };

    function init() {
        renderSidebar();
        loadSlide(1);
    }

    function getFileNum(index) {
        if (index < 1 || index > totalSlides) return 1;
        return slideFiles[index - 1];
    }

    function renderSidebar() {
        const container = document.getElementById('slideList');
        container.innerHTML = '';

        for (let i = 1; i <= totalSlides; i++) {
            const div = document.createElement('div');
            div.className = `slide-item px-6 py-3 cursor-pointer transition-colors border-l-4 border-transparent text-sm flex flex-col`;
            div.onclick = () => loadSlide(i);
            div.dataset.index = i;
            
            const title = titles[i] || `Slide ${i}`;
            const fileNum = getFileNum(i);
            
            div.innerHTML = `
                <span class="font-semibold truncate">${title}</span>
                <span class="text-xs opacity-60 mt-0.5">slide ${fileNum}.html</span>
            `;
            
            container.appendChild(div);
        }
    }

    function loadSlide(index) {
        if (index < 1 || index > totalSlides) return;
        currentSlide = index;

        // Determine file number
        const fileNum = getFileNum(index);

        // Update Iframe - Adjusted path for root directory deployment
        const iframe = document.getElementById('slideFrame');
        iframe.src = `Proposal_Presentation/${fileNum}.html`;

        // Update UI
        updateActiveState();
        updateInfo();
    }

    function updateActiveState() {
        document.querySelectorAll('.slide-item').forEach(el => {
            el.classList.remove('active');
            if (parseInt(el.dataset.index) === currentSlide) {
                el.classList.add('active');
                el.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        });
    }

    function updateInfo() {
        const title = titles[currentSlide] || `Slide ${currentSlide}`;
        document.getElementById('currentInfo').innerText = `${currentSlide}. ${title}`;
        document.getElementById('counter').innerText = `${currentSlide} / ${totalSlides}`;
        
        // Also update presentation mode counter if active
        const presCounter = document.getElementById('presCounter');
        if (presCounter) {
            presCounter.innerText = `${currentSlide} / ${totalSlides}`;
        }
    }

    function nextSlide() {
        if (currentSlide < totalSlides) loadSlide(currentSlide + 1);
    }

    function prevSlide() {
        if (currentSlide > 1) loadSlide(currentSlide - 1);
    }

    // Presentation Mode Functions
    let isPresentationMode = false;
    const SLIDE_WIDTH = 1280;
    const SLIDE_HEIGHT = 720;

    function calculateScale() {
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;
        
        // Calculate scale to fit the slide in the screen while maintaining aspect ratio
        const scaleX = screenWidth / SLIDE_WIDTH;
        const scaleY = screenHeight / SLIDE_HEIGHT;
        
        // Use the smaller scale to ensure the entire slide fits
        return Math.min(scaleX, scaleY);
    }

    function applyPresentationScale() {
        const slideContainer = document.querySelector('.slide-container');
        if (slideContainer && isPresentationMode) {
            const scale = calculateScale();
            slideContainer.style.transform = `scale(${scale})`;
        }
    }

    function removePresentationScale() {
        const slideContainer = document.querySelector('.slide-container');
        if (slideContainer) {
            slideContainer.style.transform = '';
        }
    }

    function enterPresentationMode() {
        isPresentationMode = true;
        document.body.classList.add('presentation-mode');
        updatePresentationCounter();
        
        // Apply scaling after a short delay to ensure layout is ready
        setTimeout(() => {
            applyPresentationScale();
        }, 100);
        
        // Request fullscreen
        const elem = document.documentElement;
        if (elem.requestFullscreen) {
            elem.requestFullscreen();
        } else if (elem.webkitRequestFullscreen) { // Safari
            elem.webkitRequestFullscreen();
        } else if (elem.msRequestFullscreen) { // IE11
            elem.msRequestFullscreen();
        }
    }

    function exitPresentationMode() {
        isPresentationMode = false;
        document.body.classList.remove('presentation-mode');
        removePresentationScale();
        
        // Exit fullscreen
        if (document.exitFullscreen) {
            document.exitFullscreen().catch(() => {});
        } else if (document.webkitExitFullscreen) { // Safari
            document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) { // IE11
            document.msExitFullscreen();
        }
    }

    function updatePresentationCounter() {
        const presCounter = document.getElementById('presCounter');
        if (presCounter) {
            presCounter.innerText = `${currentSlide} / ${totalSlides}`;
        }
    }

    // Listen for window resize to adjust scale in presentation mode
    window.addEventListener('resize', () => {
        if (isPresentationMode) {
            applyPresentationScale();
        }
    });

    // Listen for fullscreen changes to sync state and adjust scale
    document.addEventListener('fullscreenchange', () => {
        if (!document.fullscreenElement && isPresentationMode) {
            isPresentationMode = false;
            document.body.classList.remove('presentation-mode');
            removePresentationScale();
        } else if (document.fullscreenElement && isPresentationMode) {
            // Recalculate scale after fullscreen is applied
            setTimeout(() => {
                applyPresentationScale();
            }, 100);
        }
    });

    // Keyboard Navigation
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            e.preventDefault();
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            e.preventDefault();
            prevSlide();
        } else if (e.key === 'F5') {
            e.preventDefault();
            if (!isPresentationMode) {
                enterPresentationMode();
            }
        } else if (e.key === 'Escape') {
            if (isPresentationMode) {
                exitPresentationMode();
            }
        }
    });

    // Initialize
    init();

</script>
</body>
</html>
